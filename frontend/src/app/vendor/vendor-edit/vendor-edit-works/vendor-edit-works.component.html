<div class="ui container grid">
  <div class="row">
    <div class="column">
      <table class="ui selectable padded single line table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Category</th>
            <th>Subcategory</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let work of works">
            <td (click)="onWorkSelect(work)">{{work.Name}}</td>
            <td (click)="onWorkSelect(work)">{{work.Category}}</td>
            <td (click)="onWorkSelect(work)">{{work.Subcategory}}</td>
            <td class="right aligned">
              <button (click)="removeWork(work)" class="ui icon button">
                <i class="remove icon"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="ui divider"></div>
  <div class="two column container row">
    <div class="column">
      <form class="ui form">
        <div class="field">
          <label>Name</label>
          <input type="text" [(ngModel)]="selectedWork.Name" name="name" placeholder="WORK NAME">
        </div>
        <div class="field">
          <label>Description</label>
          <textarea [(ngModel)]="selectedWork.Description" name="description" placeholder="WRITE SOMETHING ABOUT THIS WORK..."></textarea>
        </div>
      </form>
    </div>
    <div class="column">
      <ng-template let-option #optionTemplate>
        <img class="ui avatar image category-icon" src="{{option.Icon}}">{{option.Name}}
      </ng-template>
      <sui-select class="selection fluid category-dropdown" placeholder="SELECT CATEGORY" [(ngModel)]="selectedCategory" [optionTemplate]="optionTemplate"
        [isSearchable]="true" (selectedOptionChange)="onCategorySelect()" name="selectCategory">
        <sui-select-option class="select-option" *ngFor="let category of categories" [value]="category">
        </sui-select-option>
      </sui-select>
      <ng-template let-option #optionTemplate>
        <img class="ui avatar image category-icon" src="{{option.Icon}}">{{option.Name}}
      </ng-template>
      <sui-select class="selection fluid category-dropdown" placeholder="SELECT SUBCATEGORY" [isDisabled]="selectedCategory === undefined"
        [(ngModel)]="selectedSubcategory" [optionTemplate]="optionTemplate" [isSearchable]="true" (selectedOptionChange)="onSubcategorySelect()"
        name="selectSubcategory">
        <sui-select-option class="select-option" *ngFor="let subcategory of subcategories" [value]="subcategory">
        </sui-select-option>
      </sui-select>
      <div (click)="openModal()" class="workIcon">
        <img *ngIf="selectedWork.Icon !== ''" class="ui small rounded image work-icon" src="{{selectedWork.Icon}}">
        <img *ngIf="selectedWork.Icon === ''" class="ui small rounded image work-icon" src="https://semantic-ui.com/images/wireframe/square-image.png">
      </div>
    </div>
  </div>
  <div class="ui divider"></div>
  <div class="centered row">
    <div class="three wide column">
      <button (click)="clearSelectedWork()" class="ui basic button"><h5>Cancel</h5></button>
    </div>
    <div *ngIf="selectedWork.Id === null" class="three wide column">
      <button (click)="createWork()" class="ui basic button"><h5>Add</h5></button>
    </div>
    <div *ngIf="selectedWork.Id !== null" class="three wide column">
      <button (click)="updateWork()" class="ui basic button"><h5>Save</h5></button>
    </div>
  </div>
</div>

<ng-template class="modalImage" let-context let-modal="modal" #modalTemplate>
  <div class="content">
    <div class="contentContainer">
      <div class="mainContent" align="center">
        <div class="title">
          <label>Select your photo</label>
        </div>
        <div class="uploadedImage">
          <img-cropper #cropper [image]="data" [settings]="cropperSettings"></img-cropper>
        </div>
        <div class="ui padded grid centered">
          <div class="ui active button file-upload-save" (click)="fileChangeListener(fileInput)" #fileInput>
            <svg class="svgImage" id="uploadImage" xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 20 17">
              <path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path>
            </svg>
            <input #fileInput id="custom-input" accept="image/*" type="file" name="file" id="file" (change)="fileChangeListener($event)"
              class="inputfile">
            <label class="btnText" for="file">Upload image</label>
          </div>
          <div class="ui active button file-upload-save" (click)="fileSaveListener()">
            <svg class="svgImage" id="saveImage" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
              width="20" height="17" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
              <g>
                <path d="M500,613.1L780,360H605V150H394.1v210H220L500,613.1z M958,590.1L801.9,469.8H710L845.6,605H734.9c-5,0-9.4,2.6-11.8,6.3l-40.2,99.5H316.5l-40.2-99.5c-2.2-3.9-6.8-6.3-11.8-6.3H154L290,469.8h-92.3L41.5,590.1C18.3,603.7,7,631.7,10.7,659.2l19,146.3c5,28.7,21.2,44.4,61.5,44.4h817.6c41.8,0,56.4-16.6,61.5-44.4l19-146.3C993,631,981.2,603.7,958,590.1z"
                />
              </g>
            </svg>
            <input type="submit" id="custom-input" class="inputfile">
            <label class="btnText" for="submit">Save image</label>
          </div>
        </div>
      </div>
      <div class="previewContent" *ngIf="imageUploaded">
        <div class="result rounded">
          <div class="previewTitle">
            <label>Preview</label>
          </div>
          <img class="ui small circular image uploadedImage" [src]="data.image" [width]="cropperSettings.croppedWidth" [height]="cropperSettings.croppedHeight">
        </div>
      </div>
    </div>
  </div>
</ng-template>