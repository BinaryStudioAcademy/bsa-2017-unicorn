<div class="main-content">
    <div class="ui grid container remove-margin-top-bottom" *ngIf="user !== undefined">
        <div class="row remove-padding-top">
            <div class="sixteen wide column container">
                <div class="user-header" id="user-header" [style.backgroundImage]="backgroundUrl">
                    <label id="banner-loader" for="banner-input" class="ui icon button basic" [ngClass]="{'loading': uploading}">
                    <i class="icon up-color" [ngClass]="{'upload': !uploading}"></i>
                </label>
                    <input type="file" id="banner-input" accept="image/*" (change)="bannerListener($event)">

                    <div (click)="openModal()" *ngIf="user!== undefined">
                        <div class="ui small circular image">
                            <div class="avatar">
                                <img *ngIf="!user.CroppedAvatar" id="user-avatar" src="{{user.Avatar}}" />
                                <img *ngIf="user.CroppedAvatar" id="user-avatar" src="{{user.CroppedAvatar}}" />
                            </div>
                        </div>
                    </div>
                    <div class="user-title" *ngIf="user!== undefined">
                        <h3>{{user.Name}} {{user.SurName}}</h3>
                    </div>
                    <ng-template class="modalImage" let-context let-modal="modal" #modalTemplate>
                        <div class="content">
                            <div class="contentContainer">
                                <div class="mainContent" align="center">
                                    <div class="title">
                                        <label>Select your photo</label>
                                    </div>
                                    <div class="uploadedImage">
                                        <img-cropper #cropper [image]="data" [settings]="cropperSettings"></img-cropper>
                                    </div>
                                    <div class="ui padded grid centered">
                                        <div class="ui active button file-input" #fileInput>
                                            <input #fileInput id="custom-input" accept="image/*" type="file" name="file" id="file" class="inputfile" (change)="fileChangeListener($event)">
                                            <label class="btnText" for="file">
                                                    <svg class="svgImage" id="uploadImage" xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path></svg>
                                                Upload image</label>
                                        </div>

                                        <div *ngIf="dataLoaded" class="ui active button file-input" (click)="fileSaveListener()">
                                            <input type="submit" id="custom-input" class="inputfile">
                                            <label class="btnText" for="submit">
                                                    <svg class="svgImage" id="saveImage" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="17" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">
                                                        <g><path d="M500,613.1L780,360H605V150H394.1v210H220L500,613.1z M958,590.1L801.9,469.8H710L845.6,605H734.9c-5,0-9.4,2.6-11.8,6.3l-40.2,99.5H316.5l-40.2-99.5c-2.2-3.9-6.8-6.3-11.8-6.3H154L290,469.8h-92.3L41.5,590.1C18.3,603.7,7,631.7,10.7,659.2l19,146.3c5,28.7,21.2,44.4,61.5,44.4h817.6c41.8,0,56.4-16.6,61.5-44.4l19-146.3C993,631,981.2,603.7,958,590.1z"/></g>
                                                    </svg>
                                                Save image</label>
                                        </div>
                                        <div *ngIf="!dataLoaded" class="ui active loading button file-upload-save">Loading</div>
                                    </div>
                                </div>
                                <div class="previewContent" *ngIf="imageUploaded">
                                    <div class="result rounded">
                                        <div class="previewTitle">
                                            <label>Preview</label>
                                        </div>
                                        <img class="ui small circular image uploadedImage" [src]="data.image" [width]="cropperSettings.croppedWidth" [height]="cropperSettings.croppedHeight">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </div>
            </div>
        </div>
        <div class="sixteen wide column container">
            <sui-tabset>
                <div class="ui pointing secondary menu">
                    <a routerLink="/user/{{user.Id}}/edit" [queryParams]="{tab: 'profile'}" class="item" suiTabHeader="1">EDIT</a>
                    <a routerLink="/user/{{user.Id}}/edit" [queryParams]="{tab: 'tasks'}" class="item" suiTabHeader="2" [isActive]="tasksTabActive">TASKS</a>
                    <a routerLink="/user/{{user.Id}}/edit" [queryParams]="{tab: 'messages'}" class="item" suiTabHeader="3" [isActive]="messagesTabActive">MESSAGES
                        <label *ngIf="unreadDialogCount > 0" class="unread-msg"></label>
                    </a>
                    <a routerLink="/user/{{user.Id}}/edit" [queryParams]="{tab: 'history'}" class="item" suiTabHeader="4">HISTORY</a>
                </div>
                <div class="row">
                    <div class="ui grid container">
                        <div class="row">
                            <div class="sixteen wide container column">
                                <div class="ui segment" suiTabContent="1">
                                    <app-user-profile [user]="user"></app-user-profile>
                                </div>
                            </div>
                            <div class="sixteen wide container column">
                                <div class="ui segment" suiTabContent="2">
                                    <app-user-tasks [user]="user"></app-user-tasks>
                                </div>
                            </div>
                            <div class="sixteen wide container column">
                                <div class="ui segment" suiTabContent="3">
                                    <app-user-messages></app-user-messages>
                                </div>
                            </div>
                            <div class="sixteen wide container column">
                                <div class="ui segment" suiTabContent="4">
                                    <app-user-history [user]="user"></app-user-history>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </sui-tabset>
        </div>

    </div>

</div>

<div *ngIf="user === undefined" class="ui active inverted dimmer" style="z-index: 0;">
    <div class="ui text loader">Loading</div>
</div>