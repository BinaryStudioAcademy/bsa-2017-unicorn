<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.grey-indigo.min.css" />
<div class="ui grid remove-margin-top-bottom">
  <div class="ten wide column settings-container">
      <div id="search-panel" class="row remove-padding-top">
          <div class="ui grid">
              <div class="three wide column remove-padding-bottom">
                <label>Category</label>
              </div>
              <div class="three wide column remove-padding-bottom">
                <label>Subategory</label>
              </div>
              <div class="ten wide column remove-padding-bottom">
                <label>When to do it</label>                  
              </div>
              <div class="three wide column ui input">
                <input type="text" placeholder="SCRATCH" [(ngModel)]="category">
              </div>
              <div class="three wide column  ui input">
                <input type="text" placeholder="CAT" [(ngModel)]="subcategory">
              </div>
              <div class="four wide column ui left icon input">
                  <i class="calendar icon"></i>
                  <input class="datepicker" placeholder="RIGHT NOW" suiDatepicker 
                          [(ngModel)]="date" 
                          [pickerMode]="mode" 
                          [pickerFirstDayOfWeek]="firstDayOfWeek" 
                          [pickerUseNativeOnMobile]="false">
              </div>
              <div class="six wide column search-btn-div">
                <button class="ui active button main" (click)="searchWorks()">SEARCH</button>   
                <button class="ui button button-right" (click)="reset()">RESET</button>                
              </div>
              <div class="sixteen wide column remove-padding-top">
                <sui-accordion class="fluid">
                  <sui-accordion-panel [isOpen]="filtersIsOpen">
                    <div title>
                      <i class="filter icon"></i>
                      <label>Additional filters</label>
                    </div>
                    <div content>
                      <div class="ui grid container segment">
                        <div class="eight wide column remove-padding-bottom">  
                            <div class="ui icon input full-width">                        
                              <input type="text" placeholder="VENDOR NAME" [(ngModel)]="vendorName">
                            </div>
                        </div>
                        <div class="eight wide column remove-padding-bottom">  
                          <div class="ui icon input full-width">                        
                            <input places-auto-complete
                            (initialized$)="initialized($event)"
                            (place_changed)="placeChanged(place)"
                            [types]="['geocode']" 
                            placeholder="LOCATION"
                            [(ngModel)]="place"/>
                          </div>
                        </div>
                        <div class="eight wide column remove-padding-bottom padding-top">
                          <div class="rating-container">
                            <div class="rating-box">
                              <label>Rating</label>
                              <sui-select class="inline" [(ngModel)]="ratingCompare" placeholder="rating">
                                <sui-select-option value="greater"></sui-select-option>
                                <sui-select-option value="lower"></sui-select-option>
                              </sui-select>
                            </div>
                            <sui-rating class="star" [(ngModel)]="rating"></sui-rating>                       
                          </div>                             
                        </div>  
                        <div class="eight wide column remove-padding-bottom padding-top">  
                          <label>Distance: {{slider}} km</label>  
                        </div> 
                        <div class="eight wide column remove-padding-bottom padding-top">  
                          <sui-checkbox [(ngModel)]="reviewsChecked">
                            Only with reviews
                          </sui-checkbox>                        
                        </div>  
                        <div class="eight wide column remove-padding-bottom padding-top"> 
                          <div class="rating-container">
                          <label>0</label> 
                          <mdl-slider class="slider" min="0" max="100" [(ngModel)]="slider"></mdl-slider>
                          <label>100+ km</label>
                          </div>
                        </div>
                        <div class="eight wide column">
                          <sui-multi-select [(ngModel)]="selCategories"
                                            [options]="categories"                                            
                                            icon="list"
                                            placeholder="CATEGORIES"
                                            (ngModelChange)="categoriesChanged()"
                                            #select>
                            <div class="ui icon search input">
                                <i class="search icon"></i>
                                <input suiSelectSearch type="text" placeholder="Search options...">
                            </div>
                            <div class="divider"></div>
                            <div class="header">
                                <i class="list icon"></i>
                                Categories
                            </div>
                            <div class="scrolling menu">                                
                                <sui-select-option *ngFor="let category of categories" [value]="category.Name">                                   
                                </sui-select-option>
                            </div>
                          </sui-multi-select>
                        </div>    
                        <div class="eight wide column">
                          <sui-multi-select [(ngModel)]="selSubcategories"
                                            [options]="subcategories"                                            
                                            icon="list"
                                            placeholder="SUBCATEGORIES"
                                            (ngModelChange)="subcategoriesChanged()"
                                            #select>
                            <div class="ui icon search input">
                                <i class="search icon"></i>
                                <input suiSelectSearch type="text" placeholder="Search options...">
                            </div>
                            <div class="divider"></div>
                            <div class="header">
                                <i class="list icon"></i>
                                Subcategories
                            </div>
                            <div class="scrolling menu">
                                <sui-select-option *ngFor="let subcategory of subcategories" [value]="subcategory.Name"></sui-select-option>
                            </div>
                          </sui-multi-select>
                        </div>                        
                      </div>
                    </div>
                  </sui-accordion-panel> 
                </sui-accordion>     
              </div>
              <div class="twelve wide column remove-padding-top">
                <h5 class="ui header">                  
                  <div class="content">
                    <i class="sort content descending icon"></i>
                    Sort by
                    <sui-select class="inline" [(ngModel)]="sort">
                      <sui-select-option value="rating"></sui-select-option>
                      <sui-select-option value="name"></sui-select-option>
                      <sui-select-option value="distance"></sui-select-option>
                    </sui-select>
                  </div>
                </h5>
              </div>
              <div class="four wide column remove-padding-top">
                <h5 class="ui header">                  
                  <div class="content align-right">
                    <i class="block layout icon"></i>
                    Page size:
                    <sui-select class="inline" [(ngModel)]="pageSize">
                      <sui-select-option value="20"></sui-select-option>
                      <sui-select-option value="40"></sui-select-option>
                      <sui-select-option value="60"></sui-select-option>
                    </sui-select>
                  </div>
                </h5>              
              </div>
          </div>
        <div class="ui fluid divider"></div>
      </div>

      <div *ngIf="spinner" class="ui active centered inline ui text loader">Loading</div>
      <div *ngIf="works" class="ui grid" id="works-grid">
        <div class="three column row remove-padding-top">
          <div class="column cell" *ngFor="let work of works">
            <a routerLink="/{{work.Link}}" [queryParams]="{work: work.Id}" class="ui medium image">
              <img class="ui fluid image" src="{{work.Avatar}}"/>
              <div class="row cell-info">
                <p class="cell-title">{{work.Name}}<p>
                <p>{{work.PerformerName}}<p>                                
              </div>
            </a>
            <div class="row margin-height">
                <p class="location" (click)="selectWork(work.PerformerName, work.Location)">
                    <i class="colored map pin icon"></i>{{work.Location.City}}, {{work.Location.Adress}}</p>
            </div>
            <div class="column margin-height">
                <sui-rating class="star" [ngModel]="work.Rating" [isReadonly]="true"></sui-rating>
                <a style="float: right" routerLink="/{{work.Link}}" [queryParams]="{tab: reviewsTab}">Reviews({{work.ReviewsCount}})</a>                  
            </div>
          </div>
        </div>        
      </div>
      <div *ngIf="works.length > pageSize" class="flex-centered"> 
        <sui-pagination [collectionSize]="works.length"
                        [pageSize]="pageSize"
                        [maxSize]="maxSize"
                        [hasEllipses]="hasEllipses"
                        [(page)]="selectedPage">
        </sui-pagination>     
      </div>
  </div>
  <div class="six wide column">
    <div class="row">
        <div class="map-container">
            <ngui-map (mapReady$)="onMapReady($event)" class="map" zoom="6" [center]="center" *ngIf="loaded">
                <custom-marker *ngFor="let work of getWorksPage()" 
                    [position]="[work.Location.Latitude, work.Location.Longitude]">
                    <span class="map-marker" [ngClass]="{'active-marker': selected == work.PerformerName}">
                        <a routerLink="/{{work.Link}}">{{work.PerformerName}}</a>
                    </span>
                </custom-marker>
            </ngui-map>
        </div>
    </div>
  </div>
</div>
